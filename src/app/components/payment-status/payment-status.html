<div class="payment-status-page">
  <div class="container card-wrapper">
    <div class="status-card">
      <!-- Header -->
      <div class="header">
        <div class="left">
          <h2>Payment Status</h2>
          <p class="muted">Order summary & transaction details</p>
        </div>

        <div class="actions">
          <button class="btn btn-outline" (click)="refresh()" [disabled]="refreshing()">
            @if(refreshing()) {
              <span class="dot-spinner"></span>
            } @else {
              Refresh
            }
          </button>

          <button class="btn btn-primary" (click)="goToOrders()">View Orders</button>
        </div>
      </div>

      <div class="content">
        <!-- Loading -->
        @if (loading()) {
          <div class="center">
            <div class="spinner"></div>
            <p class="muted">Checking payment status...</p>
          </div>
        }

        <!-- Error -->
        @if (errorMsg()) {
          <div class="alert error">
            {{ errorMsg() }}
          </div>
        }

        <!-- Order Not Found -->
        @if(orderNotFound()) {
          <div class="alert warning">
            Order not found. Please verify order ID.
          </div>
        }

        <!-- ORDER CARD -->
        @if(order() && !loading()) {
          <div class="order-card">
            <!-- Order Header -->
            <div class="order-header">
              <div>
                <h3>Order 
                  <span class="order-id">{{ order()?.order_id }}</span>
                </h3>

                <div class="status-badge" 
                  [ngClass]="{
                    'status-pending': order()!.order_status === 'ACTIVE' || order()!.order_status === 'PENDING',
                    'status-success': order()!.order_status === 'PAID' || order()!.order_status === 'SUCCESS',
                    'status-failed': order()!.order_status === 'FAILED' || order()!.order_status === 'CANCELLED'
                  }">
                  {{ order()?.order_status | titlecase }}
                </div>
              </div>

              <div class="amount">
                <div class="price">
                  {{ order()?.order_currency }} {{ order()?.order_amount }}
                </div>
                <div class="sub muted">Total Amount</div>
              </div>
            </div>

            <!-- Order Body -->
            <div class="order-body">
              
              <div class="left-col">
                <h4>Customer Details</h4>

                <div class="detail-row">
                  <strong>Name:</strong>
                  <span>{{ order()?.customer_details?.customer_name }}</span>
                </div>

                <div class="detail-row">
                  <strong>Email:</strong>
                  <span>{{ order()?.customer_details?.customer_email }}</span>
                </div>

                <div class="detail-row">
                  <strong>Phone:</strong>
                  <span>{{ order()?.customer_details?.customer_phone }}</span>
                </div>

                <div class="detail-row">
                  <strong>Created At:</strong>
                  <span>{{ order()?.created_at | date:'medium' }}</span>
                </div>

                <!-- <div class="detail-row">
                  <strong>Payment Session:</strong>
                  <span class="muted small">{{ order()?.payment_session_id }}</span>
                </div> -->
              </div>

            </div>

          </div>
        }

        <!-- TOAST -->
        @if (toast()) {
          <div class="toast">{{ toast() }}</div>
        }
      </div>
    </div>
  </div>
</div>
