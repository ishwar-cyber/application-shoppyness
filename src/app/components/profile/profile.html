<div class="account-page">
  <div class="layout">

    <!-- SIDEBAR -->
    <aside class="sidebar">
      <button (click)="switchSection('profile')">Profile</button>
      <button (click)="switchSection('orders')">Orders</button>
      <button (click)="switchSection('password')">Password</button>
      <button (click)="switchSection('settings')">Settings</button>
      <button (click)="logout()">Logout</button>
    </aside>

    <!-- CONTENT -->
    <main class="content" #contentRef>

      @if (isLoading()) {
        <p class="center">Loading...</p>
      }

      <!-- PROFILE -->
      @if (!isLoading() && activeSection() === 'profile') {
        <section>
          <form [formGroup]="profileForm">
            <input formControlName="username" />
            <input formControlName="email" />
            <button type="button" (click)="saveProfile()">Save</button>
          </form>
        </section>
      }

      <!-- ORDERS -->
      @if (activeSection() === 'orders') {
        <section>
          <div *ngFor="let o of orders()">
            <strong>#{{ o.id }}</strong> — ₹{{ o.totalAmount }}
          </div>

          @if (loading()) {
            <p>Loading more…</p>
          }
        </section>
      }

      <!-- PASSWORD -->
      @if (activeSection() === 'password') {
        <section>
          <form [formGroup]="passwordForm">
            <input type="password" formControlName="currentPassword" />
            <input type="password" formControlName="newPassword" />
            <input type="password" formControlName="confirmPassword" />
            <button (click)="changePassword()">Change</button>
          </form>
        </section>
      }

      <!-- SETTINGS -->
      @if (activeSection() === 'settings') {
        <section>
          @for (s of ['orderUpdates','promotions','newsletter','dataSharing','activityTracking']; track s) {
            <label>
              <input type="checkbox" [checked]="settings()[s]" />
              {{ s }}
            </label>
          }
        </section>
      }

      <!-- SCROLL TRIGGER -->
      <div #loadMoreTrigger class="scroll-trigger"></div>

    </main>
  </div>
</div>
